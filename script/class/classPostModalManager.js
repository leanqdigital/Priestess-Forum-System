class PostModalManager {
  static async open(post) {
    const modalContent = document.querySelector("#post-modal-content");
    let voteData = post.voted;
    let imageData = null,
      audioData = null,
      videoData = null;

    if (post.file_tpe === "Image" && post.file_content) {
      imageData = post.file_content;
    } else if (post.file_tpe === "Audio" && post.file_content) {
      audioData = post.file_content;
    } else if (post.file_tpe === "Video" && post.file_content) {
      videoData = post.file_content;
    }

    let containerClass = "w-[600px]";
    if (
      (post.file_tpe === "Image" && imageData) ||
      (post.file_tpe === "Video" && videoData)
    ) {
      containerClass = "w-[1250px]";
    }

    modalContent.innerHTML = `
<div
    class="flex ${containerClass} max-h-[800px] max-[1300px]:w-[900px] max-[900px]:w-screen max-[900px]:h-screen relative">


    ${
      post.file_tpe === "Image" && imageData
        ? `
    <div class="w-full h-full border-r-[10px] border-[#000000] flex-1 max-[900px]:hidden">
        ${
          imageData
            ? `
        <div class="flex flex-col gap-3 flex-1 w-full h-full">
            ${
              imageData
                ? `<img class="w-full h-full object-cover" src="${imageData.link}" alt="Post Image">`
                : ""
            }
        </div>
        `
            : ""
        }
    </div>
    `
        : ``
    }
    ${
      post.file_tpe === "Video" && videoData
        ? `
    <div class="w-full h-full border-r-[10px] border-[#000000] flex-1 max-[900px]:hidden">
        ${
          videoData
            ? `
        <div class="flex flex-col gap-3 flex-1 w-full h-full">
            ${
              videoData
                ? `<video controls width="100%" class="object-cover">
                <source src="${videoData.link}" type="${videoData.type}">
            </video>`
                : ""
            }
        </div>
        `
            : ""
        }
    </div>
    `
        : ``
    }


    <div class="flex flex-col gap-4 flex-1 post-details-modal overflow-auto">
        <div class="flex items-center justify-between px-6 py-4 w-full post-details-modal sticky top-0 z-[99999]">
            <h2 class="page-text">Post Details</h2>
            <svg class="cursor-pointer" @click="openCommentModal = false" width="14" height="14" viewBox="0 0 14 14"
                fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M12.6622 11.8364C12.7164 11.8906 12.7594 11.9549 12.7887 12.0257C12.8181 12.0965 12.8332 12.1724 12.8332 12.2491C12.8332 12.3257 12.8181 12.4016 12.7887 12.4724C12.7594 12.5432 12.7164 12.6075 12.6622 12.6617C12.608 12.7159 12.5437 12.7589 12.4729 12.7883C12.4021 12.8176 12.3262 12.8327 12.2495 12.8327C12.1729 12.8327 12.097 12.8176 12.0262 12.7883C11.9554 12.7589 11.8911 12.7159 11.8369 12.6617L6.99984 7.82399L2.16281 12.6617C2.05336 12.7712 1.90492 12.8327 1.75013 12.8327C1.59534 12.8327 1.44689 12.7712 1.33744 12.6617C1.22799 12.5523 1.1665 12.4038 1.1665 12.2491C1.1665 12.0943 1.22799 11.9458 1.33744 11.8364L6.1752 6.99935L1.33744 2.16233C1.22799 2.05288 1.1665 1.90443 1.1665 1.74964C1.1665 1.59485 1.22799 1.44641 1.33744 1.33696C1.44689 1.2275 1.59534 1.16602 1.75013 1.16602C1.90492 1.16602 2.05336 1.2275 2.16281 1.33696L6.99984 6.17471L11.8369 1.33696C11.9463 1.2275 12.0948 1.16602 12.2495 1.16602C12.4043 1.16602 12.5528 1.2275 12.6622 1.33696C12.7717 1.44641 12.8332 1.59485 12.8332 1.74964C12.8332 1.90443 12.7717 2.05288 12.6622 2.16233L7.82448 6.99935L12.6622 11.8364Z"
                    fill="black" />
            </svg>
        </div>

        <div class="flex flex-col gap-4 px-6">
            <div class="flex items-center">
                <div class="flex items-center gap-2">
                    <div class="author-image-container">
                        <img class="w-[32px] h-[32px] rounded-full" src="${
                          post.author.profileImage
                        }">
                    </div>
                    <div class="author-name-container">
                        <div
                            class="text-center page-text text-base font-semibold font-['Avenir LT Std'] leading-normal">
                            ${post.author.name}</div>
                    </div>
                    <div class="h-[15px] w-[2px] bg-[#c29d68]"></div>
                    <div class="text-center page-text text-xs font-['Avenir LT Std'] leading-3">${
                      post.date
                    }
                    </div>
                </div>
            </div>
            <div class="flex">
                <div class="post-content w-[90%]">
                    <div class="page-text text-base font-['Avenir LT Std'] leading-tight content-container">${
                      post.content
                    }.</div>
                </div>
                <div class="w-[5px] h-[auto] modal-post-content-right-border ml-auto"></div>
            </div>

            <div class="flex">
                ${
                  post.file_tpe === "Image" && imageData
                    ? `
                <div class="w-full h-full flex-1 min-[900px]:hidden">
                    ${
                      imageData
                        ? `
                    <div class="flex flex-col gap-3 flex-1 w-full h-full">
                        ${
                          imageData
                            ? `<img class="w-full h-full object-cover" src="${imageData.link}" alt="Post Image">`
                            : ""
                        }
                    </div>
                    `
                        : ""
                    }
                </div>
                `
                    : ``
                }
                ${
                  post.file_tpe === "Video" && videoData
                    ? `
                <div class="w-full h-full flex-1 min-[900px]:hidden">
                    ${
                      videoData
                        ? `
                    <div class="flex flex-col gap-3 flex-1 w-full h-full">
                        ${
                          videoData
                            ? `<video controls width="100%" class="object-cover">
                            <source src="${videoData.link}" type="${videoData.type}">
                        </video>`
                            : ""
                        }
                    </div>
                    `
                        : ""
                    }
                </div>
                `
                    : ``
                }

                ${
                  post.file_tpe === "Audio" && audioData
                    ? `
                <div class="post-audio-wrapper w-full">
                    <div class="audio-player-modal p-5 rounded-[12px] w-full text-center" id="audio-${post.id}"
                        data-audio-player-modal="${post.id}" data-audio-player="${post.id}">

                        <!-- Audio header -->
                        <div class="audio-header flex items-center gap-[10px]">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M8.24421 9.66634C9.64153 9.66634 10.774 8.54729 10.774 7.16634V3.83301C10.774 2.45206 9.64153 1.33301 8.24421 1.33301C6.84689 1.33301 5.71445 2.45206 5.71445 3.83301V7.16634C5.71445 8.54729 6.84689 9.66634 8.24421 9.66634ZM13.1549 7.13658C13.1549 7.0711 13.1014 7.01753 13.0359 7.01753H12.143C12.0775 7.01753 12.024 7.0711 12.024 7.13658C12.024 9.22438 10.332 10.9163 8.24421 10.9163C6.15641 10.9163 4.46445 9.22438 4.46445 7.13658C4.46445 7.0711 4.41088 7.01753 4.3454 7.01753H3.45254C3.38707 7.01753 3.3335 7.0711 3.3335 7.13658C3.3335 9.647 5.21742 11.7184 7.64897 12.0116V13.5354H5.48677C5.2829 13.5354 5.11921 13.7482 5.11921 14.0116V14.5473C5.11921 14.6128 5.16088 14.6663 5.21147 14.6663H11.2769C11.3275 14.6663 11.3692 14.6128 11.3692 14.5473V14.0116C11.3692 13.7482 11.2055 13.5354 11.0017 13.5354H8.77992V12.019C11.2397 11.7512 13.1549 9.66783 13.1549 7.13658Z"
                                    fill="#C29D68" />
                            </svg>
                        </div>

                        <!-- Audio element -->
                        <audio id="custom-audio-comment" class="audio">
                            <source src="${audioData.link}" type="${audioData.type}">
                        </audio>

                        <!-- Controls -->
                        <div class="controls flex justify-center gap-[15px] my-[15px]">
                            <button class="bg-transparent border-none text-[#D4AF7A] cursor-pointer" id="rewind">
                                <svg width="17" height="16" viewBox="0 0 17 16" fill="none"
                                    xmlns="http://www.w3.org/2000/svg">
                                    <path
                                        d="M15.1668 8.15293C15.167 9.77081 14.53 11.3237 13.3937 12.4754C12.2575 13.6271 10.7134 14.285 9.09568 14.3068H9.01299C7.44135 14.3107 5.92856 13.7092 4.78863 12.6273C4.73968 12.581 4.70033 12.5255 4.67282 12.464C4.64531 12.4025 4.63019 12.3362 4.62832 12.2688C4.62644 12.2015 4.63785 12.1344 4.66189 12.0715C4.68594 12.0085 4.72214 11.9509 4.76844 11.902C4.81474 11.853 4.87023 11.8137 4.93173 11.7862C4.99324 11.7587 5.05956 11.7435 5.12692 11.7417C5.19427 11.7398 5.26133 11.7512 5.32427 11.7752C5.38722 11.7993 5.44481 11.8355 5.49376 11.8818C6.22696 12.5732 7.14766 13.0333 8.14083 13.2046C9.134 13.3758 10.1556 13.2506 11.078 12.8447C12.0005 12.4387 12.7828 11.7699 13.3274 10.9218C13.8719 10.0738 14.1545 9.08408 14.1399 8.07636C14.1252 7.06864 13.8139 6.08758 13.2449 5.25573C12.676 4.42389 11.8745 3.77814 10.9406 3.39915C10.0068 3.02017 8.98194 2.92475 7.99417 3.12482C7.0064 3.32489 6.09948 3.81158 5.38671 4.52409C5.38148 4.52976 5.37591 4.53511 5.37004 4.54011L4.6944 5.1587L5.78414 6.24845C5.85694 6.31988 5.90678 6.41139 5.9273 6.51129C5.94782 6.61119 5.93809 6.71494 5.89935 6.80928C5.86061 6.90362 5.79461 6.98427 5.70981 7.04091C5.625 7.09756 5.52523 7.12763 5.42325 7.12729H2.34632C2.21032 7.12729 2.07988 7.07326 1.98371 6.97709C1.88753 6.88092 1.8335 6.75048 1.8335 6.61447V3.53755C1.83291 3.43585 1.86258 3.33626 1.91873 3.25146C1.97487 3.16666 2.05497 3.10047 2.14883 3.0613C2.24269 3.02214 2.34608 3.01177 2.44585 3.03151C2.54562 3.05125 2.63727 3.10021 2.70915 3.17217L3.96876 4.43499L4.67004 3.79396C5.53157 2.93578 6.62803 2.35208 7.82102 2.11655C9.01401 1.88101 10.25 2.0042 11.3731 2.47056C12.4961 2.93691 13.4558 3.72554 14.131 4.73687C14.8062 5.74821 15.1666 6.93691 15.1668 8.15293Z"
                                        fill="#C29D68" />
                                </svg>
                            </button>

                            <div class="cursor-pointer" id="play-pause" data-audio-button="${post.id}"
                                onclick="playAudio(${post.id})">
                                <svg class="audioStateIcon playedIcon" width="33" height="32" viewBox="0 0 33 32"
                                    fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <rect x="0.5" width="32" height="32" rx="16" fill="#C29D68" />
                                    <path
                                        d="M22.448 15.9997C22.4484 16.1738 22.4038 16.345 22.3184 16.4968C22.2331 16.6485 22.1099 16.7756 21.9609 16.8657L12.7254 22.5154C12.5697 22.6107 12.3914 22.6628 12.2088 22.6662C12.0263 22.6695 11.8461 22.6241 11.687 22.5346C11.5294 22.4465 11.3981 22.318 11.3066 22.1623C11.2151 22.0066 11.1668 21.8293 11.1665 21.6488V10.3506C11.1668 10.17 11.2151 9.99276 11.3066 9.83707C11.3981 9.68137 11.5294 9.55286 11.687 9.46473C11.8461 9.37522 12.0263 9.3298 12.2088 9.33318C12.3914 9.33656 12.5697 9.38862 12.7254 9.48396L21.9609 15.1337C22.1099 15.2237 22.2331 15.3508 22.3184 15.5026C22.4038 15.6543 22.4484 15.8256 22.448 15.9997Z"
                                        fill="#022327" />
                                </svg>
                                <svg class="audioStateIcon pausedIcon hidden" width="32" height="32" viewBox="0 0 32 32"
                                    fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <rect width="32" height="32" rx="16" fill="#C29D68" />
                                    <path
                                        d="M22.2222 10.4441V21.5552C22.2222 21.8499 22.1052 22.1325 21.8968 22.3409C21.6884 22.5493 21.4058 22.6663 21.1111 22.6663H18.3333C18.0386 22.6663 17.756 22.5493 17.5477 22.3409C17.3393 22.1325 17.2222 21.8499 17.2222 21.5552V10.4441C17.2222 10.1494 17.3393 9.86682 17.5477 9.65844C17.756 9.45007 18.0386 9.33301 18.3333 9.33301H21.1111C21.4058 9.33301 21.6884 9.45007 21.8968 9.65844C22.1052 9.86682 22.2222 10.1494 22.2222 10.4441ZM13.8889 9.33301H11.1111C10.8164 9.33301 10.5338 9.45007 10.3254 9.65844C10.1171 9.86682 10 10.1494 10 10.4441V21.5552C10 21.8499 10.1171 22.1325 10.3254 22.3409C10.5338 22.5493 10.8164 22.6663 11.1111 22.6663H13.8889C14.1836 22.6663 14.4662 22.5493 14.6746 22.3409C14.8829 22.1325 15 21.8499 15 21.5552V10.4441C15 10.1494 14.8829 9.86682 14.6746 9.65844C14.4662 9.45007 14.1836 9.33301 13.8889 9.33301Z"
                                        fill="#022327" />
                                </svg>
                            </div>

                            <button class="bg-transparent border-none text-[#D4AF7A] cursor-pointer" id="forward">
                                <svg width="17" height="16" viewBox="0 0 17 16" fill="none"
                                    xmlns="http://www.w3.org/2000/svg">
                                    <path
                                        d="M15.1668 3.53784V6.61469C15.1668 6.75069 15.1128 6.88113 15.0166 6.9773C14.9205 7.07347 14.79 7.12749 14.654 7.12749H11.5772C11.4757 7.12757 11.3765 7.09754 11.2921 7.0412C11.2077 6.98486 11.1419 6.90474 11.103 6.81099C11.0642 6.71723 11.054 6.61406 11.0738 6.51453C11.0937 6.415 11.1426 6.3236 11.2144 6.25188L12.3041 5.16216L11.6278 4.54359L11.6118 4.5282C10.899 3.81572 9.99213 3.32904 9.00439 3.12897C8.01664 2.92891 6.99185 3.02432 6.05801 3.4033C5.12418 3.78227 4.32272 4.428 3.75375 5.25983C3.18477 6.09165 2.87351 7.07269 2.85885 8.08038C2.84419 9.08808 3.12677 10.0778 3.67131 10.9258C4.21584 11.7738 4.99818 12.4426 5.92059 12.8486C6.843 13.2545 7.86459 13.3797 8.85774 13.2085C9.85088 13.0372 10.7716 12.5772 11.5047 11.8857C11.5537 11.8394 11.6113 11.8032 11.6742 11.7792C11.7372 11.7551 11.8042 11.7437 11.8716 11.7456C11.9389 11.7475 12.0052 11.7626 12.0667 11.7901C12.1283 11.8176 12.1837 11.8569 12.23 11.9059C12.2763 11.9548 12.3125 12.0124 12.3366 12.0754C12.3606 12.1383 12.372 12.2054 12.3702 12.2727C12.3683 12.3401 12.3532 12.4064 12.3257 12.4679C12.2981 12.5294 12.2588 12.5849 12.2098 12.6312C11.0696 13.7109 9.55785 14.3109 7.98752 14.3068H7.90291C6.89507 14.293 5.90606 14.0318 5.02279 13.5463C4.13952 13.0607 3.38904 12.3657 2.83731 11.5222C2.28558 10.6786 1.94949 9.71253 1.85858 8.70871C1.76767 7.70489 1.92473 6.6941 2.31594 5.7652C2.70716 4.83629 3.32056 4.0177 4.10223 3.38137C4.8839 2.74504 5.80991 2.31046 6.79887 2.11583C7.78782 1.92119 8.80945 1.97245 9.77396 2.26511C10.7385 2.55777 11.6163 3.08287 12.3304 3.79425L13.031 4.43526L14.2912 3.17247C14.3631 3.10051 14.4547 3.05155 14.5545 3.03181C14.6543 3.01207 14.7576 3.02245 14.8515 3.06161C14.9454 3.10078 15.0255 3.16697 15.0816 3.25176C15.1377 3.33656 15.1674 3.43614 15.1668 3.53784Z"
                                        fill="#C29D68" />
                                </svg>
                            </button>
                        </div>

                        <!-- Progress and volume -->
                        <div class="progress-container flex items-center gap-[10px]">
                            <span id="current-time" class="page-text text-nowrap">0:00</span>
                            <input class="flex-grow-1 appearance-none bg-grey-200 h-[3px] w-full" type="range"
                                id="progress" value="0" min="0" step="0.1">
                            <span id="total-time" class="page-text text-nowrap">-0:00</span>
                            <button id="volume">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                                    xmlns="http://www.w3.org/2000/svg">
                                    <path
                                        d="M14.4123 3.70994V20.2114C14.4144 20.3348 14.3844 20.4568 14.3254 20.5652C14.2663 20.6737 14.1801 20.765 14.0752 20.8302C13.9561 20.9011 13.8183 20.9344 13.6799 20.9258C13.5415 20.9172 13.4089 20.8671 13.2995 20.782L7.64758 16.386C7.6066 16.3536 7.57352 16.3123 7.55082 16.2653C7.52813 16.2183 7.51641 16.1667 7.51656 16.1144V7.81202C7.51672 7.75958 7.52883 7.70787 7.55199 7.66082C7.57514 7.61377 7.60872 7.57262 7.65017 7.5405L13.3021 3.14449C13.4259 3.04851 13.5788 2.99758 13.7355 3.00009C13.8921 3.0026 14.0433 3.05839 14.164 3.15828C14.2433 3.22641 14.3067 3.31114 14.3496 3.40647C14.3925 3.50181 14.4139 3.60541 14.4123 3.70994ZM5.79264 7.82581H3.37914C3.01337 7.82581 2.66258 7.97111 2.40394 8.22975C2.1453 8.48839 2 8.83918 2 9.20495V14.7215C2 15.0873 2.1453 15.4381 2.40394 15.6967C2.66258 15.9554 3.01337 16.1007 3.37914 16.1007H5.79264C5.88408 16.1007 5.97178 16.0643 6.03644 15.9997C6.1011 15.935 6.13742 15.8473 6.13742 15.7559V8.1706C6.13742 8.07915 6.1011 7.99146 6.03644 7.9268C5.97178 7.86214 5.88408 7.82581 5.79264 7.82581ZM16.7197 9.62214C16.6516 9.68198 16.596 9.75466 16.556 9.83602C16.5161 9.91738 16.4925 10.0058 16.4868 10.0963C16.481 10.1868 16.4931 10.2775 16.5224 10.3632C16.5518 10.449 16.5977 10.5282 16.6577 10.5962C16.9903 10.9739 17.1738 11.4599 17.1738 11.9632C17.1738 12.4665 16.9903 12.9526 16.6577 13.3303C16.5961 13.398 16.5486 13.4772 16.518 13.5634C16.4873 13.6495 16.4741 13.741 16.4791 13.8323C16.4842 13.9236 16.5073 14.013 16.5472 14.0953C16.5871 14.1777 16.643 14.2512 16.7116 14.3117C16.7802 14.3722 16.8602 14.4184 16.9469 14.4477C17.0335 14.477 17.1251 14.4887 17.2164 14.4823C17.3076 14.4758 17.3967 14.4513 17.4783 14.4101C17.56 14.3689 17.6326 14.3118 17.692 14.2423C18.2467 13.6126 18.5527 12.8023 18.5527 11.9632C18.5527 11.1241 18.2467 10.3138 17.692 9.6842C17.6322 9.61598 17.5595 9.56025 17.478 9.52019C17.3966 9.48014 17.308 9.45655 17.2175 9.45078C17.1269 9.44502 17.0361 9.45719 16.9502 9.48659C16.8644 9.516 16.7852 9.56206 16.7172 9.62214H16.7197ZM20.2443 7.36639C20.185 7.29547 20.112 7.2372 20.0297 7.19507C19.9474 7.15293 19.8574 7.12777 19.7652 7.1211C19.673 7.11443 19.5803 7.12637 19.4928 7.15623C19.4053 7.18608 19.3247 7.23322 19.2558 7.29487C19.1868 7.35651 19.131 7.43138 19.0916 7.51503C19.0522 7.59869 19.03 7.68941 19.0264 7.78181C19.0228 7.8742 19.0378 7.96639 19.0705 8.05287C19.1032 8.13936 19.153 8.21838 19.2168 8.28524C20.1216 9.29669 20.6219 10.6062 20.6219 11.9632C20.6219 13.3203 20.1216 14.6298 19.2168 15.6412C19.153 15.7081 19.1032 15.7871 19.0705 15.8736C19.0378 15.9601 19.0228 16.0523 19.0264 16.1447C19.03 16.2371 19.0522 16.3278 19.0916 16.4114C19.131 16.4951 19.1868 16.57 19.2558 16.6316C19.3247 16.6932 19.4053 16.7404 19.4928 16.7702C19.5803 16.8001 19.673 16.812 19.7652 16.8054C19.8574 16.7987 19.9474 16.7735 20.0297 16.7314C20.112 16.6893 20.185 16.631 20.2443 16.5601C21.3749 15.2959 22 13.6593 22 11.9632C22 10.2672 21.3749 8.63061 20.2443 7.36639Z"
                                        fill="white" />
                                </svg>
                            </button>
                        </div>

                    </div> 
                </div>
                `
                    : ""
                }
            </div>
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-6">
                    <div class="flex items-center gap-2 cursor-pointer vote-container">
                        <button class="vote-button" data-post-id="${post.id}">
                            ${
                              voteData == true
                                ? `<svg class="voted-heart" width="24" height="24" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M22 8.18423C22.0015 8.8644 21.8682 9.53811 21.6076 10.1664C21.3471 10.7947 20.9646 11.3651 20.4823 11.8446L12.5097 19.9351C12.4432 20.0025 12.364 20.0561 12.2766 20.0927C12.1893 20.1293 12.0955 20.1481 12.0008 20.1481C11.9061 20.1481 11.8123 20.1293 11.725 20.0927C11.6376 20.0561 11.5584 20.0025 11.4919 19.9351L3.51935 11.8446C2.54736 10.8738 2.00084 9.55668 2 8.18292C1.99916 6.80916 2.54408 5.49134 3.51489 4.51935C4.48569 3.54736 5.80285 3.00084 7.17661 3C8.55037 2.99916 9.8682 3.54409 10.8402 4.51489L12.0008 5.59962L13.1695 4.51132C13.8948 3.78958 14.8177 3.29892 15.8217 3.10128C16.8257 2.90364 17.8657 3.00788 18.8104 3.40085C19.7552 3.79381 20.5624 4.45788 21.1301 5.30922C21.6977 6.16055 22.0004 7.16099 22 8.18423Z"
                                    fill="#c29d68" />
                            </svg>`
                                : `<svg class="unvoted-heart" width="24" height="24" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M20.5087 4.49572C19.5548 3.54375 18.2625 3.0085 16.9149 3.00713C15.5672 3.00577 14.2739 3.53841 13.3181 4.48844L12.0022 5.71353L10.6862 4.48844C9.7311 3.53456 8.4362 2.99915 7.08635 3C5.7365 3.00085 4.44227 3.5379 3.48838 4.49299C2.5345 5.44808 1.99909 6.74298 1.99994 8.09283C2.00079 9.44269 2.53784 10.7369 3.49293 11.6908L11.6141 19.9301C11.6648 19.9815 11.7252 20.0223 11.7919 20.0501C11.8585 20.078 11.93 20.0923 12.0022 20.0923C12.0744 20.0923 12.1458 20.078 12.2125 20.0501C12.2791 20.0223 12.3395 19.9815 12.3902 19.9301L20.5087 11.6944C20.9814 11.2218 21.3565 10.6607 21.6124 10.0431C21.8682 9.42552 21.9999 8.76357 21.9999 8.09507C21.9999 7.42658 21.8682 6.76463 21.6124 6.14704C21.3565 5.52946 20.9814 4.96833 20.5087 4.49572ZM19.7344 10.9256L12.0022 18.7705L4.26724 10.9229C3.52168 10.1721 3.10407 9.15642 3.10588 8.09835C3.10768 7.04028 3.52875 6.02606 4.27686 5.27783C5.02497 4.5296 6.03913 4.10837 7.0972 4.10639C8.15526 4.10442 9.17099 4.52187 9.92188 5.2673C9.92626 5.27204 9.93114 5.27631 9.93642 5.28002L11.6305 6.85772C11.7314 6.95176 11.8642 7.00405 12.0022 7.00405C12.1401 7.00405 12.2729 6.95176 12.3739 6.85772L14.0679 5.27911C14.0732 5.2754 14.0781 5.27114 14.0824 5.26639C14.4535 4.89313 14.8946 4.59679 15.3804 4.39436C15.8662 4.19194 16.3873 4.08741 16.9136 4.08678C17.4399 4.08615 17.9611 4.18942 18.4475 4.39068C18.9338 4.59194 19.3756 4.88722 19.7475 5.25959C20.1195 5.63196 20.4143 6.07409 20.615 6.56063C20.8157 7.04717 20.9184 7.56855 20.9171 8.09486C20.9159 8.62118 20.8108 9.14207 20.6078 9.62767C20.4049 10.1133 20.108 10.554 19.7344 10.9247V10.9256Z"
                                    fill="#c29d68" />
                            </svg>`
                            }
                        </button>
                        <div class="o1 page-text postVoteCount">${
                          post.PostVotesCount
                        }</div>
                    </div>
                    <div class="flex items-center gap-2 cursor-pointer comment-container">
                        <button class="comment-button" data-post-id="${
                          post.id
                        }">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M12.375 2.25C9.88943 2.25273 7.50645 3.24133 5.74889 4.99889C3.99133 6.75645 3.00273 9.13943 3 11.625V19.5C3 19.8978 3.15804 20.2794 3.43934 20.5607C3.72064 20.842 4.10218 21 4.5 21H12.375C14.8614 21 17.246 20.0123 19.0041 18.2541C20.7623 16.496 21.75 14.1114 21.75 11.625C21.75 9.1386 20.7623 6.75403 19.0041 4.99587C17.246 3.23772 14.8614 2.25 12.375 2.25ZM15.375 14.25H9C8.80109 14.25 8.61032 14.171 8.46967 14.0303C8.32902 13.8897 8.25 13.6989 8.25 13.5C8.25 13.3011 8.32902 13.1103 8.46967 12.9697C8.61032 12.829 8.80109 12.75 9 12.75H15.375C15.5739 12.75 15.7647 12.829 15.9053 12.9697C16.046 13.1103 16.125 13.3011 16.125 13.5C16.125 13.6989 16.046 13.8897 15.9053 14.0303C15.7647 14.171 15.5739 14.25 15.375 14.25ZM15.375 11.25H9C8.80109 11.25 8.61032 11.171 8.46967 11.0303C8.32902 10.8897 8.25 10.6989 8.25 10.5C8.25 10.3011 8.32902 10.1103 8.46967 9.96967C8.61032 9.82902 8.80109 9.75 9 9.75H15.375C15.5739 9.75 15.7647 9.82902 15.9053 9.96967C16.046 10.1103 16.125 10.3011 16.125 10.5C16.125 10.6989 16.046 10.8897 15.9053 11.0303C15.7647 11.171 15.5739 11.25 15.375 11.25Z"
                                    fill="#c29d68" />
                            </svg>
                        </button>
                        <div class="o1 page-text postCommentCount">${
                          post.PostCommentCount
                        }</div>
                    </div>
                </div>
            </div>

            <div class="h-[0px] border border-[#d9d9d9]"></div>
            <section id="modal-comments-section" class="pb-[150px]">
                <div class="mb-4 max-[500px]:mb-2 page-text text-sm font-['Avenir LT Std'] leading-[14px]">Comments</div>
                <div id="modal-comments-container" class="space-y-4 pb-[150px] modal-comments-container-${
                  post.id
                }">
                    <p class="text-gray-300">Loading comments...</p>
                </div>
            </section>
        </div>
        <div class="flex gap-2 sticky bottom-0 bg-white w-full px-4 py-2 border-t-[1px] border-secondary-300">
            <div class = "profile-image-wrapper size-6 max-[500px]:hidden">
              <img class="size-full rounded-full block" src="${
                CONFIG.api.defaultLoggedInAuthorImage
              }">
             </div> 
            <div class="
                    comment-form-wrapper
                    comment-form 
                    flex 
                    flex-col 
                    flex-1
                    h-auto 
                    p-2
                    rounded-[4px] 
                    border 
                    border-grey-200 
                    bg-white
                    z-[9999]">
                <div id="comment-editor" style="font-size: 16px !important;" class="editor comment-editor page-text p-2 !border-none !focus-visible:border-none rounded" contenteditable="true"></div>
                <div class="flex flex-col gap-3 fullAudioRecordingWrapperComment hidden">
                <div class="o2 text-secondary">Audio Recording</div>
                <div class="flex p-3 items-center justify-between rounded-[12px] border border-grey-200">
                    <div class="flex items-center gap-3">
                        <div
                            class="flex items-center justify-center !p-2 !rounded-full !w-8 !h-8 icon-button stopRecordingComment cursor-pointer">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M14.6668 2.54611V13.4552C14.6668 13.7767 14.5391 14.085 14.3118 14.3123C14.0845 14.5396 13.7762 14.6673 13.4547 14.6673H2.54562C2.22414 14.6673 1.91583 14.5396 1.68852 14.3123C1.4612 14.085 1.3335 13.7767 1.3335 13.4552V2.54611C1.3335 2.22463 1.4612 1.91632 1.68852 1.68901C1.91583 1.46169 2.22414 1.33398 2.54562 1.33398H13.4547C13.7762 1.33398 14.0845 1.46169 14.3118 1.68901C14.5391 1.91632 14.6668 2.22463 14.6668 2.54611Z"
                                    fill="#C29D68" />
                            </svg>
                        </div>
                        <div class="recordingTimerComment o3 text-secondary">
                            0:00
                        </div>
                    </div>
                    <div class="waveWrapper waveWrapperComment"></div>
                    <div class="flex items-center gap-3">
                        <div
                            class="flex items-center justify-center !p-2 !rounded-full !w-8 !h-8 icon-button replaceRecordingComment cursor-pointer">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M14.6668 2.31064V5.64397C14.6668 5.79132 14.6083 5.93262 14.5041 6.03681C14.3999 6.141 14.2586 6.19953 14.1113 6.19953H10.7779C10.668 6.19962 10.5605 6.16708 10.4691 6.10604C10.3776 6.045 10.3063 5.9582 10.2643 5.85664C10.2222 5.75507 10.2112 5.6433 10.2326 5.53547C10.2541 5.42765 10.3071 5.32862 10.3849 5.25092L11.6564 3.97731C10.6335 2.99727 9.273 2.44803 7.85641 2.44328H7.82516C6.3736 2.44043 4.97928 3.00924 3.94391 4.02661C3.83782 4.12566 3.69717 4.17925 3.55207 4.17592C3.40697 4.17259 3.26893 4.11261 3.16748 4.0088C3.06604 3.905 3.00925 3.76562 3.00925 3.62048C3.00926 3.47534 3.06607 3.33596 3.16752 3.23217C4.40598 2.02215 6.06662 1.34143 7.79805 1.33405C9.52948 1.32666 11.1959 1.99318 12.4446 3.19259L13.7196 1.91759C13.7974 1.84028 13.8963 1.78771 14.0039 1.76651C14.1115 1.74531 14.2229 1.75643 14.3242 1.79846C14.4255 1.84049 14.5121 1.91155 14.573 2.00269C14.634 2.09383 14.6666 2.20098 14.6668 2.31064ZM12.0564 11.7058C11.0273 12.7109 9.64855 13.2776 8.21011 13.2868C6.77167 13.296 5.38574 12.7469 4.34391 11.7551L5.61544 10.4836C5.69395 10.406 5.74756 10.3068 5.76945 10.1986C5.79133 10.0904 5.7805 9.97815 5.73833 9.87615C5.69616 9.77415 5.62456 9.68702 5.53267 9.62588C5.44078 9.56474 5.33276 9.53236 5.22238 9.53286H1.88905C1.74171 9.53286 1.6004 9.5914 1.49621 9.69558C1.39203 9.79977 1.3335 9.94108 1.3335 10.0884V13.4218C1.33341 13.5317 1.36595 13.6392 1.42698 13.7306C1.48802 13.8221 1.57482 13.8933 1.67639 13.9354C1.77796 13.9775 1.88973 13.9885 1.99756 13.967C2.10538 13.9456 2.20441 13.8926 2.28211 13.8148L3.55572 12.5398C4.78641 13.7275 6.4287 14.3934 8.13905 14.3981H8.17586C9.91758 14.4026 11.5909 13.7208 12.8335 12.5002C12.935 12.3964 12.9918 12.2571 12.9918 12.1119C12.9918 11.9668 12.935 11.8274 12.8335 11.7236C12.7321 11.6198 12.5941 11.5598 12.449 11.5565C12.3038 11.5531 12.1632 11.6067 12.0571 11.7058H12.0564Z"
                                    fill="#C29D68" />
                            </svg>
                        </div>
                        <div
                            class="flex items-center justify-center !p-2 !rounded-full !w-8 !h-8 icon-button deleteRecordingComment cursor-pointer">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M13.7949 3.38527H11.2308V2.87245C11.2308 2.46442 11.0687 2.07311 10.7802 1.78459C10.4916 1.49607 10.1003 1.33398 9.69231 1.33398H6.61539C6.20736 1.33398 5.81605 1.49607 5.52753 1.78459C5.23901 2.07311 5.07692 2.46442 5.07692 2.87245V3.38527H2.51282C2.37681 3.38527 2.24637 3.4393 2.1502 3.53547C2.05403 3.63164 2 3.76208 2 3.89809C2 4.0341 2.05403 4.16453 2.1502 4.26071C2.24637 4.35688 2.37681 4.41091 2.51282 4.41091H3.02564V13.6417C3.02564 13.9137 3.1337 14.1746 3.32604 14.3669C3.51839 14.5593 3.77927 14.6673 4.05128 14.6673H12.2564C12.5284 14.6673 12.7893 14.5593 12.9816 14.3669C13.174 14.1746 13.2821 13.9137 13.2821 13.6417V4.41091H13.7949C13.9309 4.41091 14.0613 4.35688 14.1575 4.26071C14.2537 4.16453 14.3077 4.0341 14.3077 3.89809C14.3077 3.76208 14.2537 3.63164 14.1575 3.53547C14.0613 3.4393 13.9309 3.38527 13.7949 3.38527ZM6.10256 2.87245C6.10256 2.73644 6.15659 2.606 6.25277 2.50983C6.34894 2.41365 6.47938 2.35963 6.61539 2.35963H9.69231C9.82832 2.35963 9.95876 2.41365 10.0549 2.50983C10.1511 2.606 10.2051 2.73644 10.2051 2.87245V3.38527H6.10256V2.87245ZM12.2564 13.6417H4.05128V4.41091H12.2564V13.6417ZM7.12821 6.97501V11.0776C7.12821 11.2136 7.07418 11.344 6.978 11.4402C6.88183 11.5364 6.75139 11.5904 6.61539 11.5904C6.47938 11.5904 6.34894 11.5364 6.25277 11.4402C6.15659 11.344 6.10256 11.2136 6.10256 11.0776V6.97501C6.10256 6.839 6.15659 6.70856 6.25277 6.61239C6.34894 6.51622 6.47938 6.46219 6.61539 6.46219C6.75139 6.46219 6.88183 6.51622 6.978 6.61239C7.07418 6.70856 7.12821 6.839 7.12821 6.97501ZM10.2051 6.97501V11.0776C10.2051 11.2136 10.1511 11.344 10.0549 11.4402C9.95876 11.5364 9.82832 11.5904 9.69231 11.5904C9.5563 11.5904 9.42586 11.5364 9.32969 11.4402C9.23352 11.344 9.17949 11.2136 9.17949 11.0776V6.97501C9.17949 6.839 9.23352 6.70856 9.32969 6.61239C9.42586 6.51622 9.5563 6.46219 9.69231 6.46219C9.82832 6.46219 9.95876 6.51622 10.0549 6.61239C10.1511 6.70856 10.2051 6.839 10.2051 6.97501Z"
                                    fill="#E57C7C" />
                            </svg>
                        </div>
                        <div
                            class="flex items-center justify-center !p-2 !rounded-full !w-8 !h-8 icon-button approveRecordingComment cursor-pointer">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M14.4399 4.64775L6.23722 12.8504C6.16578 12.9221 6.08089 12.979 5.98741 13.0178C5.89394 13.0566 5.79372 13.0766 5.69251 13.0766C5.5913 13.0766 5.49109 13.0566 5.39761 13.0178C5.30414 12.979 5.21925 12.9221 5.1478 12.8504L1.55912 9.26177C1.48759 9.19024 1.43085 9.10531 1.39213 9.01185C1.35342 8.91839 1.3335 8.81822 1.3335 8.71706C1.3335 8.6159 1.35342 8.51572 1.39213 8.42226C1.43085 8.3288 1.48759 8.24388 1.55912 8.17235C1.63065 8.10081 1.71558 8.04407 1.80904 8.00536C1.9025 7.96665 2.00267 7.94672 2.10383 7.94672C2.20499 7.94672 2.30517 7.96665 2.39863 8.00536C2.49209 8.04407 2.57701 8.10081 2.64854 8.17235L5.69315 11.217L13.3518 3.55961C13.4962 3.41514 13.6922 3.33398 13.8965 3.33398C14.1008 3.33398 14.2967 3.41514 14.4412 3.55961C14.5857 3.70408 14.6668 3.90002 14.6668 4.10432C14.6668 4.30863 14.5857 4.50457 14.4412 4.64903L14.4399 4.64775Z"
                                    fill="#C29D68" />
                            </svg>
                        </div>
                    </div>
                </div>
            </div>
                <div id="file-preview-container-comment" class="flex flex-col gap-2">
                    <!-- Wrappers for file previews (only one will be used at a time) -->
                    <div id="image-preview-wrapper-comment" class="w-[200px]"></div>
                    <div id="audio-preview-wrapper-comment" class="w-full"></div>
                    <div id="video-preview-wrapper-comment" class="w-[200px]"></div>

                    <!-- New file control buttons: Refresh (to re-upload the same type) and Clear (to reset) -->
                    <div id="file-controls-comment" class="hidden flex gap-2 items-center justify-end mb-2">
                        <button id="refresh-upload-comment" class="icon-button" type="button">
                            <svg width="14" height="14" viewBox="0 0 14 14" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M13.6668 1.31064V4.64397C13.6668 4.79132 13.6083 4.93262 13.5041 5.03681C13.3999 5.141 13.2586 5.19953 13.1113 5.19953H9.77794C9.668 5.19962 9.5605 5.16708 9.46906 5.10604C9.37762 5.045 9.30635 4.9582 9.26426 4.85664C9.22218 4.75507 9.21117 4.6433 9.23265 4.53547C9.25412 4.42765 9.3071 4.32862 9.38488 4.25092L10.6564 2.97731C9.63354 1.99727 8.273 1.44803 6.85641 1.44328H6.82516C5.3736 1.44043 3.97928 2.00924 2.94391 3.02661C2.83782 3.12566 2.69717 3.17925 2.55207 3.17592C2.40697 3.17259 2.26893 3.11261 2.16748 3.0088C2.06604 2.905 2.00925 2.76562 2.00925 2.62048C2.00926 2.47534 2.06607 2.33596 2.16752 2.23217C3.40598 1.02215 5.06662 0.341433 6.79805 0.334045C8.52948 0.326657 10.1959 0.993183 11.4446 2.19259L12.7196 0.917586C12.7974 0.840277 12.8963 0.787713 13.0039 0.766514C13.1115 0.745315 13.2229 0.756429 13.3242 0.798457C13.4255 0.840485 13.5121 0.911547 13.573 1.00269C13.634 1.09384 13.6666 1.20098 13.6668 1.31064ZM11.0564 10.7058C10.0273 11.7109 8.64855 12.2776 7.21011 12.2868C5.77167 12.296 4.38574 11.7469 3.34391 10.7551L4.61544 9.48356C4.69395 9.40597 4.74756 9.30676 4.76945 9.19858C4.79133 9.0904 4.7805 8.97815 4.73833 8.87615C4.69616 8.77415 4.62456 8.68702 4.53267 8.62588C4.44078 8.56474 4.33276 8.53236 4.22239 8.53286H0.889052C0.741709 8.53286 0.600402 8.59139 0.496215 8.69558C0.392028 8.79977 0.333496 8.94108 0.333496 9.08842V12.4218C0.33341 12.5317 0.365946 12.6392 0.426985 12.7306C0.488024 12.8221 0.574822 12.8933 0.676391 12.9354C0.777959 12.9775 0.889731 12.9885 0.997556 12.967C1.10538 12.9456 1.20441 12.8926 1.28211 12.8148L2.55572 11.5398C3.78641 12.7275 5.4287 13.3934 7.13905 13.3981H7.17586C8.91758 13.4026 10.5909 12.7208 11.8335 11.5002C11.935 11.3964 11.9918 11.2571 11.9918 11.1119C11.9918 10.9668 11.935 10.8274 11.8335 10.7236C11.7321 10.6198 11.5941 10.5598 11.449 10.5565C11.3038 10.5531 11.1632 10.6067 11.0571 10.7058H11.0564Z"
                                    fill="#c29d68" />
                            </svg>
                        </button>
                        <button id="delete-upload-comment" class="icon-button" type="button">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M13.7949 3.38527H11.2308V2.87245C11.2308 2.46442 11.0687 2.07311 10.7802 1.78459C10.4916 1.49607 10.1003 1.33398 9.69231 1.33398H6.61539C6.20736 1.33398 5.81605 1.49607 5.52753 1.78459C5.23901 2.07311 5.07692 2.46442 5.07692 2.87245V3.38527H2.51282C2.37681 3.38527 2.24637 3.4393 2.1502 3.53547C2.05403 3.63164 2 3.76208 2 3.89809C2 4.0341 2.05403 4.16453 2.1502 4.26071C2.24637 4.35688 2.37681 4.41091 2.51282 4.41091H3.02564V13.6417C3.02564 13.9137 3.1337 14.1746 3.32604 14.3669C3.51839 14.5593 3.77927 14.6673 4.05128 14.6673H12.2564C12.5284 14.6673 12.7893 14.5593 12.9816 14.3669C13.174 14.1746 13.2821 13.9137 13.2821 13.6417V4.41091H13.7949C13.9309 4.41091 14.0613 4.35688 14.1575 4.26071C14.2537 4.16453 14.3077 4.0341 14.3077 3.89809C14.3077 3.76208 14.2537 3.63164 14.1575 3.53547C14.0613 3.4393 13.9309 3.38527 13.7949 3.38527ZM7.12821 11.0776C7.12821 11.2136 7.07418 11.344 6.978 11.4402C6.88183 11.5364 6.75139 11.5904 6.61539 11.5904C6.47938 11.5904 6.34894 11.5364 6.25277 11.4402C6.15659 11.344 6.10256 11.2136 6.10256 11.0776V6.97501C6.10256 6.839 6.15659 6.70856 6.25277 6.61239C6.34894 6.51622 6.47938 6.46219 6.61539 6.46219C6.75139 6.46219 6.88183 6.51622 6.978 6.61239C7.07418 6.70856 7.12821 6.839 7.12821 6.97501V11.0776ZM10.2051 11.0776C10.2051 11.2136 10.1511 11.344 10.0549 11.4402C9.95876 11.5364 9.82832 11.5904 9.69231 11.5904C9.5563 11.5904 9.42586 11.5364 9.32969 11.4402C9.23352 11.344 9.17949 11.2136 9.17949 11.0776V6.97501C9.17949 6.839 9.23352 6.70856 9.32969 6.61239C9.42586 6.51622 9.5563 6.46219 9.69231 6.46219C9.82832 6.46219 9.95876 6.51622 10.0549 6.61239C10.1511 6.70856 10.2051 6.839 10.2051 6.97501V11.0776ZM10.2051 3.38527H6.10256V2.87245C6.10256 2.73644 6.15659 2.606 6.25277 2.50983C6.34894 2.41365 6.47938 2.35963 6.61539 2.35963H9.69231C9.82832 2.35963 9.95876 2.41365 10.0549 2.50983C10.1511 2.606 10.2051 2.73644 10.2051 2.87245V3.38527Z"
                                    fill="#c29d68" />
                            </svg>
                        </button>
                    </div>
                </div>
                <div class="flex items-center justify-between w-full">
                    <div class="flex items-center gap-2">
                        <input type="file" id="comment-image-upload" accept="image/*" style="display: none;">
                        <button id="upload-image-button-comment" class="icon-button" type="button">
                            <svg width="16" height="17" viewBox="0 0 16 17" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M13.5 3H2.5C2.23478 3 1.98043 3.10536 1.79289 3.29289C1.60536 3.48043 1.5 3.73478 1.5 4V13C1.5 13.2652 1.60536 13.5196 1.79289 13.7071C1.98043 13.8946 2.23478 14 2.5 14H13.5C13.7652 14 14.0196 13.8946 14.2071 13.7071C14.3946 13.5196 14.5 13.2652 14.5 13V4C14.5 3.73478 14.3946 3.48043 14.2071 3.29289C14.0196 3.10536 13.7652 3 13.5 3ZM13.5 4V10.4219L11.8706 8.79313C11.7778 8.70024 11.6675 8.62656 11.5462 8.57629C11.4248 8.52602 11.2948 8.50015 11.1634 8.50015C11.0321 8.50015 10.902 8.52602 10.7807 8.57629C10.6594 8.62656 10.5491 8.70024 10.4563 8.79313L9.20625 10.0431L6.45625 7.29313C6.26873 7.10573 6.01448 7.00046 5.74937 7.00046C5.48427 7.00046 5.23002 7.10573 5.0425 7.29313L2.5 9.83562V4H13.5ZM2.5 11.25L5.75 8L10.75 13H2.5V11.25ZM13.5 13H12.1644L9.91438 10.75L11.1644 9.5L13.5 11.8363V13ZM9 6.75C9 6.60166 9.04399 6.45666 9.1264 6.33332C9.20881 6.20999 9.32594 6.11386 9.46299 6.05709C9.60003 6.00032 9.75083 5.98547 9.89632 6.01441C10.0418 6.04335 10.1754 6.11478 10.2803 6.21967C10.3852 6.32456 10.4566 6.4582 10.4856 6.60368C10.5145 6.74917 10.4997 6.89997 10.4429 7.03701C10.3861 7.17406 10.29 7.29119 10.1667 7.3736C10.0433 7.45601 9.89834 7.5 9.75 7.5C9.55109 7.5 9.36032 7.42098 9.21967 7.28033C9.07902 7.13968 9 6.94891 9 6.75Z"
                                    fill="#C29D68" />
                            </svg>
                        </button>
                        <input type="file" id="comment-audio-upload" accept="audio/*" style="display: none;">
                        <div id="commentAudioOptionsWrapper" class="commentAudioOptionsWrapper relative">
                            <button x-on:click="openCommentAudioOptions = !openCommentAudioOptions" aria-haspopup="true" class="icon-button">
                                <svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path
                                        d="M8.24421 10.1663C9.64153 10.1663 10.774 9.04729 10.774 7.66634V4.33301C10.774 2.95206 9.64153 1.83301 8.24421 1.83301C6.84689 1.83301 5.71445 2.95206 5.71445 4.33301V7.66634C5.71445 9.04729 6.84689 10.1663 8.24421 10.1663ZM13.1549 7.63658C13.1549 7.5711 13.1014 7.51753 13.0359 7.51753H12.143C12.0775 7.51753 12.024 7.5711 12.024 7.63658C12.024 9.72438 10.332 11.4163 8.24421 11.4163C6.15641 11.4163 4.46445 9.72438 4.46445 7.63658C4.46445 7.5711 4.41088 7.51753 4.3454 7.51753H3.45254C3.38707 7.51753 3.3335 7.5711 3.3335 7.63658C3.3335 10.147 5.21742 12.2184 7.64897 12.5116V14.0354H5.48677C5.2829 14.0354 5.11921 14.2482 5.11921 14.5116V15.0473C5.11921 15.1128 5.16088 15.1663 5.21147 15.1663H11.2769C11.3275 15.1663 11.3692 15.1128 11.3692 15.0473V14.5116C11.3692 14.2482 11.2055 14.0354 11.0017 14.0354H8.77992V12.519C11.2397 12.2512 13.1549 10.1678 13.1549 7.63658Z"
                                        fill="#C29D68" />
                                </svg>
                            </button>

                            <div x-cloak x-show="openCommentAudioOptions" x-transition x-on:click.outside="openCommentAudioOptions = false;"
                                x-on:keydown.down.prevent="$focus.wrap().next()"
                                x-on:keydown.up.prevent="$focus.wrap().previous()"
                                class="commentAudioDropdownOptions absolute top-[-4rem] right-[-1rem] w-max flex flex-col rounded sort-options-wrapper p-1 shadow-[0px_4px_4px_0px_#0000000F]">
                                <!-- Dropdown Items -->
                                <button id="upload-audio-button-comment" type="button"
                                    class="o3 cursor-pointer rounded p-[10px] text-left sort-option sort-button">Upload
                                    Audio</button>
                                <button id="record-audio-button-comment" type="button"
                                    class="o3 cursor-pointer rounded p-[10px] text-left sort-option sort-button">Record
                                    Audio</button>
                            </div>
                        </div>
                        <input type="file" id="comment-video-upload" accept="video/*" style="display: none;">
                        <button id="upload-video-button-comment" class="icon-button" type="button">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M11.1107 4.88888V11.1111C11.1107 11.3468 11.0171 11.5729 10.8504 11.7396C10.6837 11.9063 10.4576 12 10.2219 12H2.22189C1.98615 12 1.76005 11.9063 1.59336 11.7396C1.42666 11.5729 1.33301 11.3468 1.33301 11.1111V4.88888C1.33301 4.65314 1.42666 4.42705 1.59336 4.26035C1.76005 4.09365 1.98615 4 2.22189 4H10.2219C10.4576 4 10.6837 4.09365 10.8504 4.26035C11.0171 4.42705 11.1107 4.65314 11.1107 4.88888ZM14.3329 4.90277C14.2702 4.88743 14.205 4.88554 14.1415 4.89722C14.078 4.9089 14.0177 4.93389 13.9646 4.97055L12.0985 6.21443C12.0681 6.23474 12.0431 6.26226 12.0259 6.29453C12.0086 6.3268 11.9996 6.36284 11.9996 6.39943V9.60053C11.9996 9.63712 12.0086 9.67316 12.0259 9.70543C12.0431 9.7377 12.0681 9.76522 12.0985 9.78553L13.9752 11.0366C14.0454 11.0835 14.1276 11.1094 14.212 11.1112C14.2964 11.1131 14.3796 11.0909 14.4518 11.0472C14.5187 11.0047 14.5735 10.9458 14.611 10.876C14.6486 10.8063 14.6676 10.7281 14.6663 10.6489V5.33333C14.6663 5.23476 14.6336 5.13897 14.5733 5.06103C14.5129 4.98309 14.4284 4.92742 14.3329 4.90277Z"
                                    fill="#C29D68" />
                            </svg>
                        </button>
                    </div>
                    <button id="submit-comment"
                        class="submit-button flex items-center gap-2 rounded px-4 py-2 page-text transition-colors">
                        
                        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M11.1662 5.99246C11.1666 6.14096 11.1273 6.28687 11.0524 6.41509C10.9775 6.54331 10.8697 6.64919 10.7401 6.72177L1.99252 11.7233C1.86699 11.7944 1.72527 11.8321 1.58098 11.8327C1.44803 11.832 1.31719 11.7995 1.19936 11.7379C1.08154 11.6763 0.980152 11.5874 0.903674 11.4787C0.827196 11.3699 0.777842 11.2444 0.759734 11.1127C0.741625 10.981 0.755286 10.8469 0.799577 10.7215L2.20611 6.55663C2.21985 6.51591 2.24585 6.48044 2.28055 6.45507C2.31524 6.42971 2.35693 6.41569 2.3999 6.41494H6.16523C6.22236 6.41506 6.27891 6.40344 6.33136 6.38079C6.38381 6.35814 6.43104 6.32495 6.47012 6.28328C6.50921 6.24161 6.5393 6.19235 6.55855 6.13855C6.57779 6.08476 6.58576 6.02758 6.58198 5.97058C6.57253 5.86341 6.52294 5.76377 6.44315 5.69162C6.36336 5.61946 6.25926 5.5801 6.15168 5.58144H2.40094C2.35734 5.58144 2.31484 5.56777 2.27943 5.54235C2.24401 5.51693 2.21745 5.48105 2.2035 5.43974L0.796973 1.27537C0.74099 1.11575 0.734897 0.942879 0.779504 0.779715C0.82411 0.616551 0.917305 0.470821 1.04671 0.361883C1.17611 0.252946 1.33559 0.185958 1.50397 0.169819C1.67235 0.15368 1.84166 0.189153 1.9894 0.271527L10.7411 5.26679C10.87 5.3392 10.9772 5.44457 11.0519 5.57208C11.1266 5.69959 11.1661 5.84468 11.1662 5.99246Z"
                                fill="#000000" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
`;
    const commentFormConfig = {
      editor: document.getElementById("comment-editor"),
      imageUploadInput: document.getElementById("comment-image-upload"),
      audioUploadInput: document.getElementById("comment-audio-upload"),
      videoUploadInput: document.getElementById("comment-video-upload"),
      uploadImageBtn: document.getElementById("upload-image-button-comment"),
      uploadAudioBtn: document.getElementById("upload-audio-button-comment"),
      uploadVideoBtn: document.getElementById("upload-video-button-comment"),
      imagePreviewWrapper: document.getElementById(
        "image-preview-wrapper-comment"
      ),
      audioPreviewWrapper: document.getElementById(
        "audio-preview-wrapper-comment"
      ),
      videoPreviewWrapper: document.getElementById(
        "video-preview-wrapper-comment"
      ),
      fileControls: document.getElementById("file-controls-comment"),
      audioOptionsWrapper: document.getElementById(
        "commentAudioOptionsWrapper"
      ),
      recordAudioBtn: document.getElementById("record-audio-button-comment"),
      stopRecordingBtn: document.querySelector(".stopRecordingComment"),
      replaceRecordingBtn: document.querySelector(".replaceRecordingComment"),
      deleteRecordingBtn: document.querySelector(".deleteRecordingComment"),
      approveRecordingBtn: document.querySelector(".approveRecordingComment"),
      fullAudioRecordingWrapper: document.querySelector(
        ".fullAudioRecordingWrapperComment"
      ),
      recordingTimer: document.querySelector(".recordingTimerComment"),
      waveWrapper: document.querySelector(".waveWrapperComment"),
      refreshBtn: document.getElementById("refresh-upload-comment"),
      deleteUploadBtn: document.getElementById("delete-upload-comment"),
      // modal property is optional if your comment form is within a modal already handled elsewhere
      modal: null,
    };
    window.commentMediaFormHandler = new MediaFormHandler(commentFormConfig);
    MentionManager.tribute.attach(commentFormConfig.editor);
    document
      .getElementById("submit-comment")
      .addEventListener("click", async () => {
        const commentForm = document.querySelector(".comment-form-wrapper");
        const editor = commentFormConfig.editor;
        const content = editor.innerHTML.trim();
        if (!content) {
          UIManager.showError("Comment cannot be empty");
          return;
        }
        const imageFile = commentFormConfig.imageUploadInput.files[0];
        const audioFile =
          commentFormConfig.audioUploadInput.files[0] ||
          window.commentMediaFormHandler.currentRecordedAudioFile;
        const videoFile = commentFormConfig.videoUploadInput.files[0];

        let uploadedFile = null;
        let fileType = null;
        if (imageFile) {
          uploadedFile = imageFile;
          fileType = "Image";
        } else if (audioFile) {
          uploadedFile = audioFile;
          fileType = "Audio";
        } else if (videoFile) {
          uploadedFile = videoFile;
          fileType = "Video";
        }
        const mentions = [];
        const tempContainer = document.createElement("div");
        tempContainer.innerHTML = content;
        tempContainer.querySelectorAll(".mention").forEach((mention) => {
          const id = mention.dataset.contactId;
          if (id) {
            if (id === "all" && MentionManager.allContacts) {
              MentionManager.allContacts.forEach((contact) => {
                if (!mentions.includes(contact.id)) {
                  mentions.push(contact.id);
                }
              });
            } else if (!mentions.includes(id)) {
              mentions.push(id);
            }
          }
        });

        commentForm.classList.add("state-disabled");

        let fileData = null;
        if (uploadedFile) {
          const fileFields = [
            { fieldName: "file_content", file: uploadedFile },
          ];
          const toSubmitFields = {};
          await processFileFields(
            toSubmitFields,
            fileFields,
            awsParam,
            awsParamUrl
          );
          fileData =
            typeof toSubmitFields.file_content === "string"
              ? JSON.parse(toSubmitFields.file_content)
              : toSubmitFields.file_content;
          fileData.name = fileData.name || uploadedFile.name;
          fileData.size = fileData.size || uploadedFile.size;
          fileData.type = fileData.type || uploadedFile.type;
        }

        try {
          await forumManager.createComment(
            post.id,
            content,
            mentions,
            fileType,
            uploadedFile,
            fileData
          );

          editor.innerHTML = "";
          commentFormConfig.imageUploadInput.value = "";
          commentFormConfig.audioUploadInput.value = "";
          commentFormConfig.videoUploadInput.value = "";
          commentFormConfig.imagePreviewWrapper.innerHTML = "";
          commentFormConfig.audioPreviewWrapper.innerHTML = "";
          commentFormConfig.videoPreviewWrapper.innerHTML = "";
          formatPreiview();
        } catch (error) {
          console.error("Error creating comment:", error);
          UIManager.showError("Failed to create comment. Please try again.");
        } finally {
          commentForm.classList.remove("state-disabled");
        }
      });

    await PostModalManager.loadComments(post.id);
  }

  static async confirmDeleteComment(commentId) {
    const confirmed = await UIManager.showDeleteConfirmation(
      "Are you sure you want to delete this comment?"
    );
    if (!confirmed) return;
    try {
      await PostModalManager.deleteComment(commentId);
      document.querySelector(`[data-comment-id="${commentId}"]`).remove();
      UIManager.showSuccess("Comment deleted successfully.");
    } catch (error) {
      UIManager.showError("Failed to delete comment.");
    }
  }

  static async deleteComment(commentId) {
    const query = `
      mutation deleteForumComment($id: PriestessForumCommentID) {
        deleteForumComment(query: [{ where: { id: $id } }]) {
          id
        }
      }
    `;
    const variables = { id: commentId };
    const toDeleteComment = document.querySelector(
      `[data-comment-id="${commentId}"]`
    );
    toDeleteComment.classList.add("state-disabled");
    await ApiService.query(query, variables);
  }

  static async loadComments(postId) {
    try {
      const comments = await forumManager.fetchComments(postId);
      await Promise.all(
        comments.map(async (comment) => {
          const voteRecords = await forumManager.fetchVoteForComment(
            comment.id
          );
          comment.isCommentVoted = voteRecords.length > 0;
          // comment.voteCommentCount = voteRecords.length;
        })
      );

      const commentsContainer = document.getElementById(
        "modal-comments-container"
      );
      const commentTemplate = $.templates("#comment-template");
      commentsContainer.innerHTML = commentTemplate.render(comments);

      document.querySelectorAll(".delete-comment-btn").forEach((button) => {
        button.addEventListener("click", (e) => {
          const commentId = e.target.dataset.commentId;
          PostModalManager.confirmDeleteComment(commentId);
        });
      });

      const replyEditors = commentsContainer.querySelectorAll(".reply-editor");
      replyEditors.forEach((editor) => {
        setTimeout(() => {
          MentionManager.tribute.attach(editor);
        }, 500);
      });

      loadRepliesForComments(comments);
      formatPreiview();
    } catch (error) {
      document.getElementById(
        "modal-comments-container"
      ).innerHTML = `<p class="text-red-300">Error loading comments</p>`;
    }

    async function loadRepliesForComments(comments) {
      await Promise.all(
        comments.map(async (comment) => {
          try {
            const replies = await forumManager.fetchReplies(comment.id);

            await Promise.all(
              replies.map(async (reply) => {
                const voteRecords = await forumManager.fetchVoteForReply(
                  reply.id
                );
                reply.isReplyVoted = voteRecords.length > 0;
              })
            );

            const container = document.querySelector(
              `[data-comment-id="${comment.id}"] .replies-container`
            );
            if (container) {
              const replyTemplate = $.templates("#reply-template");
              container.innerHTML = replies
                .map((reply) => replyTemplate.render(reply))
                .join("");
            }
            formatPreiview();
          } catch (error) {}
        })
      );
    }
  }
}
